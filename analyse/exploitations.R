# Profil des exploitations par archipel (cultures, elevage, coprah)
profilExploitationsParArchipel <- rga23_champ %>%
  group_by(Archipel) %>%
  summarize(
    ExploitationsCultures = sum(CultureValideRGA, na.rm = TRUE),
    ExploitationsElevage = sum(ElevageValideRGA, na.rm = TRUE),
    CoprahValideRGA = sum(CoprahValideRGA, na.rm = TRUE)
  )

totalExploitationsCultures <- sum(profilExploitationsParArchipel$ExploitationsCultures, na.rm = TRUE)
totalExploitationsElevage <- sum(profilExploitationsParArchipel$ExploitationsElevage, na.rm = TRUE)
totalCoprahValideRGA <- sum(profilExploitationsParArchipel$CoprahValideRGA, na.rm = TRUE)

profilExploitationsParArchipelEtTotal <- profilExploitationsParArchipel |>
  add_row(
    Archipel = "Total",
    ExploitationsCultures = totalExploitationsCultures,
    ExploitationsElevage = totalExploitationsElevage,
    CoprahValideRGA = totalCoprahValideRGA
  )

## Utilisation produits phyto
produitsPhyto <- rga23_exploitations |>
  filter(eligibilite == 1) |>
  mutate(`Utilisation produits phyto` = case_when(
    UtilisationPhytosanit == 1 ~ "OUI",
    UtilisationPhytosanit == 2 ~ "NON"
  )) |>
  group_by(`Utilisation produits phyto`) |>
  summarise(n = n()) |>
  mutate(`En %` = round((n / sum(n) * 100), 2)) |>
  select(!n)

typeProduitsPhyto <- rga23_exploitations |>
  filter(UtilisationPhytosanit == 1) |>
  mutate(`Type produits phyto` = case_when(
    TypePhytosanit__1 == 1 & TypePhytosanit__2 == 1 ~ "Synthétique + Biologique",
    TypePhytosanit__1 == 1 ~ "Synthétique (chimique)",
    TypePhytosanit__2 == 1 ~ "Biologique"
  )) |>
  group_by(`Type produits phyto`) |>
  summarise(n = n()) |>
  mutate(`En %` = round((n / sum(n) * 100), 1)) |>
  select(!n)

## Utilisation engrais
engrais <- rga23_exploitations |>
  filter(RaisonsRecensement__1 == 1 & eligibilite == 1) |>
  mutate(`Utilisation engrais` = case_when(
    UtilisationEngrais == 1 ~ "OUI",
    UtilisationEngrais == 2 ~ "NON"
  )) |>
  group_by(`Utilisation engrais`) |>
  summarise(n = n()) |>
  mutate(`En %` = round((n / sum(n) * 100), 2)) |>
  select(!n)

### Bio ?
exploitationsBio <- rga23_exploitations |>
  group_by(AgriBio) |>
  count()
