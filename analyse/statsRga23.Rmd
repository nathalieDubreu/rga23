---
title: "Stats RGA"
author: "NDubreu"
date: '2023-09-14'
output: md_document
---

# [RGA23] Quelques stats 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning=FALSE)
```

`r eligiblesRGA |> count()` unités <font color = "orange">(pas de contrôle de l'appartenance au champ du RGA)</font>

## SAU déclarée

```{r, echo=FALSE}

kable(eligiblesCultivateurs |>
  mutate(SAU = case_when(is.na(SurfaceTotalProdAgri) ~ as.numeric(NA), TRUE ~ as.numeric(SurfaceTotalProdAgri))) |>
  summarise(
    `SAU totale (en Ha)` = round(sum(SAU, na.rm = TRUE) / 10000,1),
    `SAU moyenne (en Ha)` = round(mean(SAU, na.rm = TRUE) / 10000,2),
    `SAU max (en Ha)` = max(SAU, na.rm = TRUE) / 10000
  ))
```

## Types de cultures des `r surfacesCulturesEligibles |> distinct(interview__key) |> count()` cultivateurs ayant déclarés des cultures classiques organisées

```{r, echo=FALSE}

kable(surfacesCultures)
```

## `r eligiblesEleveurs |> count()` éleveurs

### Répartition des élevages

```{r, echo=FALSE}

kable(eligiblesEleveurs |>
  summarise(
    elevBovins = sum(PresenceAnimaux__1, na.rm = TRUE),
    elevOvins = sum(PresenceAnimaux__2, na.rm = TRUE),
    elevPorcins = sum(PresenceAnimaux__3, na.rm = TRUE),
    elevVolailles = sum(PresenceAnimaux__4, na.rm = TRUE),
    elevEquides = sum(PresenceAnimaux__5, na.rm = TRUE),
    elevLapins = sum(PresenceAnimaux__6, na.rm = TRUE),
    elevAbeilles = sum(PresenceAnimaux__7, na.rm = TRUE),
    elevCaprins = sum(PresenceAnimaux__8, na.rm = TRUE)
  ))
```

### Poules pondeuses - `r eligiblesEleveurs |> filter(TypeVolailles__1 == 1 | TypeVolailles__3 == 1 | TypeVolailles__4 == 1) |> count()` éleveurs

- Poules bio

```{r, echo=FALSE}

kable(eligiblesEleveurs |> filter(TypeVolailles__4 == 1) |> summarize(
  NbMoyenPoules0 = round(sum(NombrePoules0, na.rm = TRUE) / sum(TypeVolailles__4, na.rm = TRUE)),
  NbOeufsMoyen0 = round(sum(ProductionPoules0, na.rm = TRUE) / sum(TypeVolailles__4, na.rm = TRUE),0),
  OeufsParPoules0 = round(NbOeufsMoyen0 / NbMoyenPoules0,0),
  NbMinOeufsPoules0 = min(ProductionPoules0 / NombrePoules0, na.rm = TRUE),
  NbMaxOeufsPoules0 = max(ProductionPoules0 / NombrePoules0, na.rm = TRUE)
))
```

- Poules plein air ou au sol

```{r, echo=FALSE}

kable(eligiblesEleveurs |> filter(TypeVolailles__3 == 1) |> summarize(
  NbMoyenPoules12 = round(sum(NombrePoules1, na.rm = TRUE) / sum(TypeVolailles__3, na.rm = TRUE)),
  NbOeufsMoyen12 = round(sum(ProductionPoules1, na.rm = TRUE) / sum(TypeVolailles__3, na.rm = TRUE),0),
  OeufsParPoules12 = round(NbOeufsMoyen12 / NbMoyenPoules12,0),
  NbMinOeufsPoules12 = min(ProductionPoules1 / NombrePoules1, na.rm = TRUE),
  NbMaxOeufsPoules12 = max(ProductionPoules1 / NombrePoules1, na.rm = TRUE)
))
```

- Poules en cage

```{r, echo=FALSE}

kable(eligiblesEleveurs |> filter(TypeVolailles__1 == 1) |> summarize(
  NbMoyenPoules3 = round(sum(NombrePoules3, na.rm = TRUE) / sum(TypeVolailles__1, na.rm = TRUE)),
  NbOeufsMoyen3 = round(sum(ProductionPoules3, na.rm = TRUE) / sum(TypeVolailles__1, na.rm = TRUE),0),
  OeufsParPoules3 = round(NbOeufsMoyen3 / NbMoyenPoules3,0),
  NbMinOeufsPoules3 = min(ProductionPoules3 / NombrePoules3, na.rm = TRUE),
  NbMaxOeufsPoules3 = max(ProductionPoules3 / NombrePoules3, na.rm = TRUE)
))
```

### Abeilles - `r eligiblesEleveurs |> filter(PresenceAnimaux__7 == 1) |> count()` apiculteurs

```{r, echo=FALSE}

kable(eligiblesEleveurs |> filter(PresenceAnimaux__7 == 1) |>
  mutate(KiloMiel = ProductionRuches / NbRuchesRecoltees) |> summarize(
  nbRuchesPourProduire = sum(NbRuchesPourProduire),
  nbRuchesRecoltees = sum(NbRuchesRecoltees, na.rm = TRUE),
  moyennekiloMiel = sum(ProductionRuches, na.rm = TRUE) / sum(NbRuchesRecoltees, na.rm = TRUE),
  maxKiloMiel = max(KiloMiel, na.rm = TRUE),
  minKiloMiel = min(KiloMiel, na.rm = TRUE)
))
```

## Coprahculteurs

```{r, echo=FALSE}

kable(eligiblesRGA |>
  filter(RaisonsRecensement__3 == 1) |>
  summarize(
    `Nb de producteurs de coprah` = n(),
    `Nb de cocoteraies exploitées` = sum(NbCocoteraies),
    `- en tant que propriétaire plein` = sum(nbCocoStatut1),
    `- en tant que propriétaire en indivision` = sum(nbCocoStatut2),
    `- en tant qu'exploitant` = sum(nbCocoStatut3),
    `Nb moyen de cocoteraies` = round(mean(NbCocoteraies), 2),
    `Nb min de cocoteraies` = min(NbCocoteraies),
    `Nb max de cocoteraies` = max(NbCocoteraies)
  ))
```

