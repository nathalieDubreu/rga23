---
title: "Stats RGA"
author: "NDubreu"
date: '2023-09-14'
output: md_document
---

# [RGA23] Quelques stats 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning=FALSE)
```

## Zoom sur l'appartenance au champ des `r eligiblesRGA |> count()` unités recensées

```{r, echo=FALSE}

kable(inner_join(rga23,idExploitantsDansLeChamp, by=c("interview__key"))  |>
  summarise(
    `Ensemble` = n(),
    `Cultivateurs` = sum(CultureValide == 1, na.rm = TRUE),
    `Eleveurs` = sum(ElevageValide == 1, na.rm = TRUE)
  ))
```
```{r, echo=FALSE}

kable(inner_join(rga23, idExploitantsDansLeChamp, by=c("interview__key")) |>
  group_by(ArchipelExploitation) |>
  count()
  )
```

# Comptages sur les `r eligiblesRGA |> count()` unités recensées 
<font color = "orange">**Sans prendre en compte leur appartenance au champ du RGA**</font>

## SAU déclarée

```{r, echo=FALSE}

kable(eligiblesCultivateurs |>
  mutate(SAU = case_when(is.na(SurfaceTotalProdAgri) ~ as.numeric(NA), TRUE ~ as.numeric(SurfaceTotalProdAgri))) |>
  summarise(
    `SAU totale (en Ha)` = round(sum(SAU, na.rm = TRUE) / 10000,1),
    `SAU moyenne (en Ha)` = round(mean(SAU, na.rm = TRUE) / 10000,2),
    `SAU max (en Ha)` = max(SAU, na.rm = TRUE) / 10000
  ))
```

## Types de cultures des `r surfacesCulturesEligibles |> distinct(interview__key) |> count()` cultivateurs ayant déclarés des cultures classiques organisées

```{r, echo=FALSE}

kable(surfacesCultures)
```

## `r eligiblesEleveurs |> count()` éleveurs

### Répartition des élevages

```{r, echo=FALSE}

kable(eligiblesEleveurs |>
  summarise(
    elevBovins = sum(PresenceAnimaux__1, na.rm = TRUE),
    elevOvins = sum(PresenceAnimaux__2, na.rm = TRUE),
    elevPorcins = sum(PresenceAnimaux__3, na.rm = TRUE),
    elevVolailles = sum(PresenceAnimaux__4, na.rm = TRUE),
    elevEquides = sum(PresenceAnimaux__5, na.rm = TRUE),
    elevLapins = sum(PresenceAnimaux__6, na.rm = TRUE),
    elevAbeilles = sum(PresenceAnimaux__7, na.rm = TRUE),
    elevCaprins = sum(PresenceAnimaux__8, na.rm = TRUE)
  ))
```

### Poules pondeuses - `r eligiblesEleveurs |> filter(TypeVolailles__1 == 1 | TypeVolailles__3 == 1 | TypeVolailles__4 == 1) |> count()` éleveurs



```{r, echo=FALSE}
poules <- eligiblesEleveurs |> filter(TypeVolailles__4 == 1) |> summarize(
  NbPoules0 = sum(NombrePoules0, na.rm = TRUE),
  NbOeufs0 = sum(ProductionPoules0, na.rm = TRUE),
  OeufsParPoules0 = round(NbOeufs0 / NbPoules0,0),
  NbMinOeufsPoules0 = round(min(ProductionPoules0 / NombrePoules0, na.rm = TRUE),0),
  NbMaxOeufsPoules0 = round(max(ProductionPoules0 / NombrePoules0, na.rm = TRUE),0)
)
```
- Poules bio - *`r eligiblesEleveurs |> filter(TypeVolailles__4 == 1) |> count()` élevages*
  - `r poules$NbPoules0` poules code 0 déclarées
  - `r poules$OeufsParPoules0` oeufs par poule en moyenne
  - Nombre minimum d'oeufs par poule : `r poules$NbMinOeufsPoules0`
  - Nombre maximum d'oeufs par poule : `r poules$NbMaxOeufsPoules0`

<br/>

```{r, echo=FALSE}
poules <- eligiblesEleveurs |> filter(TypeVolailles__3 == 1) |> summarize(
  NbPoules12 = sum(NombrePoules1, na.rm = TRUE),
  NbOeufs12 = sum(ProductionPoules1, na.rm = TRUE),
  OeufsParPoules12 = round(NbOeufs12 / NbPoules12,0),
  NbMinOeufsPoules12 = round(min(ProductionPoules1 / NombrePoules1, na.rm = TRUE),0),
  NbMaxOeufsPoules12 = round(max(ProductionPoules1 / NombrePoules1, na.rm = TRUE),0)
)
```
- Poules plein air ou au sol - *`r eligiblesEleveurs |> filter(TypeVolailles__3 == 1) |> count()` élevages*
  - `r poules$NbPoules12` poules code 1 ou 2 déclarées
  - `r poules$OeufsParPoules12` oeufs par poule en moyenne
  - Nombre minimum d'oeufs par poule : `r poules$NbMinOeufsPoules12`
  - Nombre maximum d'oeufs par poule : `r poules$NbMaxOeufsPoules12`

<br/>  

```{r, echo=FALSE}
poules <- eligiblesEleveurs |> filter(TypeVolailles__1 == 1) |> summarize(
  NbPoules3 = sum(NombrePoules3, na.rm = TRUE),
  NbOeufs3 = sum(ProductionPoules3, na.rm = TRUE),
  OeufsParPoules3 = round(NbOeufs3 / NbPoules3,0),
  NbMinOeufsPoules3 = round(min(ProductionPoules3 / NombrePoules3, na.rm = TRUE),0),
  NbMaxOeufsPoules3 = round(max(ProductionPoules3 / NombrePoules3, na.rm = TRUE),0)
)
```
- Poules en cage - *`r eligiblesEleveurs |> filter(TypeVolailles__1 == 1) |> count()` élevages*
  - `r as.character(poules$NbPoules3)` poules code 3 déclarées
  - `r as.character(poules$OeufsParPoules3)` oeufs par poule en moyenne
  - Nombre minimum d'oeufs par poule : `r poules$NbMinOeufsPoules3`
  - Nombre maximum d'oeufs par poule : `r poules$NbMaxOeufsPoules3`

<br/>

### Abeilles - `r eligiblesEleveurs |> filter(PresenceAnimaux__7 == 1) |> count()` apiculteurs

```{r, echo=FALSE}
kable(eligiblesEleveurs |> filter(PresenceAnimaux__7 == 1) |>
  mutate(KiloMiel = ProductionRuches / NbRuchesRecoltees) |> summarize(
  nbRuchesPourProduire = sum(NbRuchesPourProduire),
  nbRuchesRecoltees = sum(NbRuchesRecoltees, na.rm = TRUE),
  moyennekiloMiel = sum(ProductionRuches, na.rm = TRUE) / sum(NbRuchesRecoltees, na.rm = TRUE),
  maxKiloMiel = max(KiloMiel, na.rm = TRUE),
  minKiloMiel = min(KiloMiel, na.rm = TRUE)
))
```

## Coprahculteurs

```{r, echo=FALSE}
table <- eligiblesRGA |>
  filter(RaisonsRecensement__3 == 1) |>
  summarize(
    NbProdCoprah = n(),
    NbCocoExploitees = sum(NbCocoteraies),
    NbCocoExploiteesPP = sum(nbCocoStatut1),
    NbCocoExploiteesPI = sum(nbCocoStatut2),
    NbCocoExploiteesE = sum(nbCocoStatut3),
    NbMoyCoco = round(mean(NbCocoteraies), 2),
    NbMinCoco = min(NbCocoteraies),
    NbMaxCoco = max(NbCocoteraies)
  )
```
- `r table$NbProdCoprah` producteurs de coprah

- `r table$NbCocoExploitees` cocoteraies exploitées
  - `r table$NbCocoExploiteesPP` en tant que propriétaire plein
  - `r table$NbCocoExploiteesPI` en tant que propriétaire en indivision,
  - `r table$NbCocoExploiteesE` en tant qu'exploitant
  
- `r table$NbMoyCoco` cocoteraies exploitées en moyenne
  - `r table$NbMinCoco` cocoteraies exploitées au minimum
  - `r table$NbMaxCoco` cocoteraies exploitées au maximum
