# Nombre de coexploitants

nbCoexploitantsTypeExpl <- rga23_mainOeuvre |>
  mutate(Archipel_1 = "Total Polynésie") |>
  group_by(Archipel_1, TypeExploitation) |>
  summarize(
    nbUnites = n(),
    nbCoexploitants = sum(NbCoExploitants, na.rm = TRUE),
    moyenneCoexploitants = mean(coalesce(NbCoExploitants, 0))
  ) |>
  pivot_wider(names_from = TypeExploitation, values_from = c(nbCoexploitants, nbUnites, moyenneCoexploitants)) |>
  select(
    Archipel_1,
    contains("Cultivateurs"),
    contains("Eleveurs"),
    contains("Producteurs"),
    contains("Pluriactifs")
  )

nbCoexploitantsArchipelTypeExpl <- rga23_mainOeuvre |>
  group_by(Archipel_1, TypeExploitation) |>
  summarize(
    nbUnites = n(),
    nbCoexploitants = sum(NbCoExploitants, na.rm = TRUE),
    moyenneCoexploitants = mean(coalesce(NbCoExploitants, 0))
  ) |>
  pivot_wider(names_from = TypeExploitation, values_from = c(nbCoexploitants, nbUnites, moyenneCoexploitants)) |>
  select(
    Archipel_1,
    contains("Cultivateurs"),
    contains("Eleveurs"),
    contains("Producteurs"),
    contains("Pluriactifs")
  )

nbCoexploitantsArchipelSeuils <- rbind(nbCoexploitantsArchipelTypeExpl, nbCoexploitantsTypeExpl)

writeCSV(nbCoexploitantsArchipelTypeExpl)


## SAU

sauMoyenneTypeExpl <- rga23_prodVegetales |>
  group_by(Archipel_1, TypeExploitation) |>
  summarize(
    nbUnites = n(),
    sauMoyenne = round(mean(coalesce(SurfaceTotalProdAgri, 0)))
  ) |>
  pivot_wider(names_from = TypeExploitation, values_from = c(nbUnites, sauMoyenne)) |>
  select(
    Archipel_1,
    contains("Cultivateurs"),
    contains("Eleveurs"),
    contains("Producteurs"),
    contains("Pluriactifs")
  )

sauMoyenneTypeExpl <- rbind(
  sauMoyenneTypeExpl,
  rga23_prodVegetales |>
    mutate(Archipel_1 = "Total Polynésie") |>
    group_by(Archipel_1, TypeExploitation) |>
    summarize(
      nbUnites = n(),
      sauMoyenne = round(mean(coalesce(SurfaceTotalProdAgri, 0)))
    ) |>
    pivot_wider(names_from = TypeExploitation, values_from = c(nbUnites, sauMoyenne)) |>
    select(
      Archipel_1,
      contains("Cultivateurs"),
      contains("Eleveurs"),
      contains("Producteurs"),
      contains("Pluriactifs")
    )
)
writeCSV(sauMoyenneTypeExpl)

